library(dplyr)
library(ggplot2)
activityData <- read.csv('activity.csv')
str(activityData)
totalDaily <- activityData %>%
mutate(date = as.Date(date)) %>% group_by(date) %>%
summarise(TotalSteps = sum(steps, na.rm=TRUE))
View(totalDaily)
ggplot(totalDaily, aes(TotalSteps)) + geom_histogram()
averageDaily <- activityData %>% group_by(interval) %>%
summarise(steps = mean(steps, na.rm=TRUE))
ggplot(averageDaily, aes(interval, steps)) + geom_path()
View(averageDaily)
averageDaily <- activityData %>% group_by(date) %>%
summarise(steps = mean(steps, na.rm=TRUE))
daily_means = averageDaily$steps
daily_means
names(daily_means) = averageDaily$date
daily_means
fillNA = function(row){
if(!is.na(activityData$steps[row])){
return(activityData$steps[row])
}
date = as.character(activityData$date[row])
mean = daily_means[date]
if(is.na(mean)){
return(0)
}
return(mean)
}
fillNA2 = function(row) {
steps = activityData$steps[i]
if(!(is.na(steps))){
return(steps)
}
date = activityData$date[i]
steps = daily_means[date]
if(is.na(steps)) {
return(0)
}
return(steps)
}
any(fillNA(1:length(activityData))!=fillNA2(1:length(activityData)))
fillNA(1:length(activityData))
any(sapply(1:17568, fillNA) != sapply(1:17568))
any(sapply(1:17568, fillNA) != sapply(1:17568, fillNA2))
sapply(1:17568, fillNA)
sapply(1:17568, fillNA2)
fillNA2 = function(row) {
steps = activityData$steps[row]
if(!(is.na(steps))){
return(steps)
}
date = activityData$date[row]
steps = daily_means[date]
if(is.na(steps)) {
return(0)
}
return(steps)
}
any(sapply(1:17568, fillNA) != sapply(1:17568, fillNA2))
sapply(1:17568, fillNA2)
x = sapply(1:17568, fillNA2)
mean(x==0)
y = activityData$steps
mean(is.na(y))
mean(y==0)
bad = is.na(y)
y[-bad]
y = y[-bad]
mean(y==0)
y = activityData$steps
bad = which(is.na(y))
y[-bad]
any(is.na(y[-bad]))
y = y[-bad]
mean(y==0)
averageDaily <- activityData %>% group_by(interval) %>%
summarise(steps = mean(steps, na.rm=TRUE))
View(averageDaily)
head(averageDaily)
interval_means = averageDaily$steps
names(interval_means) = averageDaily$interval
interval_means[1:20]
fillNA2 = function(row) {
steps = activityData$steps[row]
if(!(is.na(steps))){
return(steps)
}
interval = activityData$interval[row]
steps = interval_means[as.character(interval)]
if(is.na(steps)) {
return(0)
}
return(steps)
}
fillNA2(1)
fillNA2(2)
fillNA2(3)
View(activityData)
fillNA2(3632)
fillNA2(3631)
fillNA2(3636)
averageDaily <- activityData %>% group_by(interval) %>%
summarise(steps = mean(steps, na.rm=TRUE))
daily_means = averageDaily$steps
names(daily_means) = averageDaily$date
fillNA = function(row) {
steps = activityData$steps[row]
if(!(is.na(steps))){
return(steps)
}
interval = activityData$interval[row]
steps = interval_means[as.character(interval)]
if(is.na(steps)) {
return(0)
}
return(steps)
}
tidyData <- activityData
tidyData$steps <- sapply(
1:length(tidyData),
fillNA
)
averageDaily <- activityData %>% group_by(interval) %>%
summarise(steps = mean(steps, na.rm=TRUE))
interval_means = averageDaily$steps
names(interval_means) = averageDaily$interval
fillNA = function(row) {
steps = activityData$steps[row]
if(!(is.na(steps))){
return(steps)
}
interval = activityData$interval[row]
steps = interval_means[as.character(interval)]
if(is.na(steps)) {
return(0)
}
return(steps)
}
tidyData <- activityData
tidyData$steps <- sapply(
1:length(tidyData),
fillNA
)
sapply(
1:length(tidyData),
fillNA
)
sapply(1:length(tidyData), fillNA)
lapply(1:length(tidyData), fillNA)
averageDaily <- activityData %>% group_by(interval) %>%
summarise(steps = mean(steps, na.rm=TRUE))
interval_means = averageDaily$steps
names(interval_means) = averageDaily$interval
fillNA = function(row) {
steps = activityData$steps[row]
if(!(is.na(steps))){
return(steps)
}
interval = activityData$interval[row]
steps = interval_means[as.character(interval)]
if(is.na(steps)) {
return(0)
}
return(steps)
}
tidyData <- activityData
tidyData$steps <- sapply(
1:nrow(tidyData),
fillNA
)
tidyData[1:15,]
totalDaily <- tidyData %>%
mutate(date = as.Date(date)) %>% group_by(date) %>%
summarise(TotalSteps = sum(steps, na.rm=TRUE))
ggplot(totalDaily, aes(TotalSteps)) + geom_histogram()
ggplot(totalDaily, aes(TotalSteps)) + geom_histogram()
View(tidyData)
str(tidyData)
tidyData <- tidyData %>% mutate(date = as.Date(date))
tidyData <- tidyData %>% mutate(day=weekdays(data))
tidyData <- tidyData %>% mutate(day=weekdays(date))
head(tidyData)
tidyData <- tidyData %>% mutate(weekend = (day %in% c('Saturday', 'SUnday')) )
head(tidyData)
str(tidyData)
tidyData <- tidyData %>% mutate(weekend = as.factor(weekend))
str(tidyData)
head(tidyData)
tidyData <- tidyData %>% group_by(interval, weekend)
head(tidyData)
tidyData <- tidyData %>% summarise()
head(tidyData)
tidyData <- activityData
tidyData$steps <- sapply(
1:nrow(tidyData),
fillNA
)
tidyData <- tidyData %>% mutate(date = as.Date(date)) %>%
mutate(day=weekdays(data)) %>%
mutate(weekend = (day %in% c('Saturday', 'SUnday')) ) %>%
mutate(weekend = as.factor(weekend))
tidyData <- tidyData %>% mutate(date = as.Date(date)) %>%
mutate(day=weekdays(date)) %>%
mutate(weekend = (day %in% c('Saturday', 'SUnday')) ) %>%
mutate(weekend = as.factor(weekend))
x = tidyData
tidyData <- tidyData %>% summarise(steps=mean(steps))
head(tidyData)
x
tidyData = x
tidyData <- tidyData %>% mutate(date = as.Date(date)) %>%
mutate(day=weekdays(date)) %>%
mutate(weekend = (day %in% c('Saturday', 'SUnday')) ) %>%
mutate(weekend = as.factor(weekend))
tidyData <- tidyData %>% group_by(interval, date)
tidyData <- tidyData %>% summarise(steps = mean(steps))
tidyData
tidyData = x
tidyData <- tidyData %>% mutate(date = as.Date(date)) %>%
mutate(day=weekdays(date)) %>%
mutate(weekend = (day %in% c('Saturday', 'SUnday')) ) %>%
mutate(weekend = as.factor(weekend))
tidyData <- tidyData %>% group_by(interval, weekend)
tidyData <- tidyData %>% summarise(steps = mean(steps))
tidyData
?vars
ggplot(tidyData, aes(steps)) + geom_histogram() + facet_grid(cols = vars(weekend))
tidyData <- tidyData %>%
mutate(date = as.Date(date)) %>%
mutate(day=weekdays(date)) %>%
mutate(weekend = (day %in% c('Saturday', 'Sunday')) ) %>%
mutate(weekend = as.factor(weekend))
tidyData = x
tidyData <- tidyData %>%
mutate(date = as.Date(date)) %>%
mutate(day=weekdays(date)) %>%
mutate(weekend = (day %in% c('Saturday', 'Sunday')) ) %>%
mutate(weekend = as.factor(weekend))
head(tidyData)
factor(tidyData$weekend)
factor(tidyData$weekend, c('Weekday', 'Weekend'))
factor(tidyData$weekend, labels=c('Weekday', 'Weekend'))
tidyData <- x %>%
mutate(date = as.Date(date)) %>%
mutate(day=weekdays(date)) %>%
mutate(weekend = (day %in% c('Saturday', 'Sunday')) ) %>%
mutate(weekend = factor(weekend, labels=c('Weekday', 'Weekend'))) %>%
group_by(interval) %>%
summarise(TotalSteps = sum(steps))
View(tidyData)
ggplot(tidyData, aes(TotalSteps)) + geom_histogram()
ggplot(tidyData, aes(TotalSteps)) + geom_histogram()
tidyData <- x %>%
mutate(date = as.Date(date)) %>%
mutate(day=weekdays(date)) %>%
mutate(weekend = (day %in% c('Saturday', 'Sunday')) ) %>%
mutate(weekend = factor(weekend, labels=c('Weekday', 'Weekend'))) %>%
group_by(interval) %>%
summarise(TotalSteps = sum(steps, na.rm=TRUE))
ggplot(tidyData, aes(TotalSteps)) + geom_histogram()
